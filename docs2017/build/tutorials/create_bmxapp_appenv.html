<html lang="en">
<head>
  <title>IBM&reg; Cloudant&reg; NoSQL DB for Bluemix&reg;</title>
  <meta charset="utf-8"></meta>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
  <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
</head>

<body>
  <!-- Acrolinx: 2017-01-10 -->

  <h1 id="creating-a-simple-bluemix-application-to-access-a-cloudant-database-the-application-environment">Creating a simple Bluemix application to access a Cloudant database: the application environment</h1>
  <p class="shortdesc">This section of the tutorial describes how to set up the application environment you must have for creating an IBM&reg; Bluemix&reg; application.</p>
  <div id="creating"></div>
  <h2 id="creating-a-bluemix-application-environment">Creating a Bluemix application environment</h2>
  <ol>
    <li>
      <p>Log in to your Bluemix account. The Bluemix dashboard can be found at:
        <a href="http://bluemix.net" target="_blank">http://bluemix.net <img src="../images/launch-glyph.svg" alt="External link icon" title="External link icon"></a>. After you authenticate with your user name and password, the Bluemix dashboard appears:<br>
        <img src="images/img0001.png" alt="Bluemix dashboard"></p>
    </li>
    <li>
      <p>Click the &#39;<code>Catalog</code>&#39; link:<br>
        <img src="images/img0002.png" alt="Bluemix catalog link"><br> A list of the services available on Bluemix appears.</p>
    </li>
    <li>
      <p>Click the &#39;<code>Cloud Foundry Apps</code>&#39; entry under the <code>Apps</code> heading:<br>
        <img src="images/img0012.png" alt="Bluemix Cloud Foundry Apps"><br> A list of the Cloud Foundry Applications available on Bluemix appears.</p>
    </li>
    <li>
      <p>Click the &#39;<code>Python</code>&#39; entry:<br>
        <img src="images/img0013.png" alt="Bluemix Python Cloud Foundry App"><br> A &#39;<code>Create a Cloud Foundry App</code>&#39; form appears.</p>
    </li>
    <li>
      <p>Use the &#39;<code>Create a Cloud Foundry App</code>&#39; form to specify and create the environment for your Python Cloud Foundry application. Enter a name for your application, for example &#39;<code>Cloudant Python</code>&#39;. The host name
        is generated for you automatically, although you can customize it:<br>
        <img src="images/img0014.png" alt="Bluemix Python Cloud Foundry App names"><br></p>
      <blockquote>
        <p> <strong>Note</strong>: The host name must be unique within the Bluemix domain. In this example, the domain is &#39;<code>mybluemix.net</code>&#39;, giving a full host name of &#39;<code>Cloudant-Python.mybluemix.net</code>&#39;.</p>
      </blockquote>
    </li>
    <li>
      <p>Click &#39;<code>Create</code>&#39; to create the application environment:<br>
        <img src="images/img0015.png" alt="Create the Bluemix Python Cloud Foundry App"></p>
    </li>
    <li>
      <p>After a short pause, the &#39;<code>Getting Started</code>&#39; window for your new application environment appears. A test application is automatically created within the environment. The application is started automatically, as shown by the green
        icon and <code>Your app is running</code> status. The application is a &#39;heartbeat&#39; program, sufficient to show that the new application environment is ready for you to use. Click the <code>Dashboard</code>&#39; link to return to your Bluemix
        account dashboard.<br>
        <img src="images/img0016.png" alt="The new Bluemix Python Cloud Foundry App running for the first time"></p>
    </li>
    <li>
      <p>Your dashboard now includes the newly created application environment:<br>
        <img src="images/img0017.png" alt="The basic Bluemix Python Cloud Foundry App appearing in the dashboard"></p>
    </li>
  </ol>
  <p>You now have a Bluemix Python application environment, ready to use.</p>
  <p>To work with a Cloudant NoSQL DB database instance, the next step is to create a &#39;connection&#39; between the application environment and the database instance.</p>
  <div id="connecting"></div>
  <h2 id="connecting-bluemix-applications-and-services">Connecting Bluemix applications and services</h2>
  <p>This section of the tutorial explains how you connect Bluemix application environments and services by using the configuration and management area of your application.</p>
  <ol>
    <li>
      <p>From your Bluemix dashboard, click the entry for your application.<br>
        <img src="images/img0018.png" alt="Selecting your application on the Bluemix dashboard"><br></p>
      <blockquote>
        <p> <strong>Note</strong>: Avoid the &#39;<code>Route</code>&#39; column, as clicking the link that is associated with your application invokes the application rather than taking you to the configuration area. A better place to click is on the name
          of your application.</p>
      </blockquote>
      <p>The configuration and management overview area for your application appears.</p>
    </li>
    <li>
      <p>To connect the application environment to another service, click the &#39;<code>Connections</code>&#39; link:<br>
        <img src="images/img0019.png" alt="Selecting the connection configuration for your Bluemix application"><br> An area appears for configuring a connection between your application and any other services available within your account.</p>
    </li>
    <li>
      <p>A <a href="create_bmxapp_prereq.html#prerequisites">prerequisite</a> for this tutorial is an existing Cloudant NoSQL DB database instance. Click &#39;<code>Connect existing</code>&#39; to establish a connection between that database instance and
        your application:<br>
        <img src="images/img0020.png" alt="Connect to an existing database instance"><br> A list of the existing service instances in your account appears.</p>
    </li>
    <li>
      <p>Click the Cloudant NoSQL DB database instance that you want to use. This tutorial uses the &#39;<code>Cloudant Service 2017</code>&#39; instance:<br>
        <img src="images/img0021.png" alt="Choose the tutorial example database instance"></p>
    </li>
    <li>
      <p>You are asked to confirm that you really want to connect the database instance to your application. Click &#39;<code>Connect</code>&#39; to confirm the connection:<br>
        <img src="images/img0022.png" alt="Confirm connection to the database instance"></p>
    </li>
    <li>
      <p>Modifying the service connections for an application affects its overall configuration. The modification requires a &#39;restaging&#39; of the application, which also forces a running application to stop. A window appears for you to confirm that
        you are ready for the &#39;restaging&#39; to proceed. Click &#39;<code>Restage</code>&#39; to continue:<br>
        <img src="images/img0023.png" alt="Confirm restaging of the application"></p>
    </li>
    <li>
      <p>The service connections page reappears. It now includes the newly connected database instance:<br>
        <img src="images/img0024.png" alt="The newly connected database instance"></p>
    </li>
  </ol>
  <p>The application environment and the database instance are now connected. The next step is to ensure that the necessary tools are installed for you to work with Bluemix applications.</p>
  <div id="toolkits"></div>
  <h2 id="the-cloud-foundry-and-bluemix-command-toolkits">The Cloud Foundry and Bluemix command toolkits</h2>
  <p>This section of the tutorial describes the toolkits that must be installed to work with your Bluemix environment, applications, and services.</p>
  <p>The <a href="https://en.wikipedia.org/wiki/Cloud_Foundry" target="_blank">Cloud Foundry <img src="../images/launch-glyph.svg" alt="External link icon" title="External link icon"></a> toolkit is a collection of tools for working with applications that
    are deployed in a Cloud Foundry-compatible environment. Use these tools for tasks such as updating a deployed application, or to start and stop a running application.</p>
  <p>The Bluemix toolkit provides extra capabilities, which are required for working with applications hosted and running within a Bluemix environment.</p>
  <p>Downloading and installing the toolkits is a one-off task. If the toolkits are already installed and working on your system, you do not need to download them again, unless they are updated.</p>
  <p>General information about the toolkits is available
    <a href="https://console.ng.bluemix.net/docs/cli/index.html" target="_blank">here <img src="../images/launch-glyph.svg" alt="External link icon" title="External link icon"></a>.</p>
  <h3 id="installing-the-cloud-foundry-toolkit">Installing the Cloud Foundry toolkit</h3>
  <p>Some operating system distributions have a version of the Cloud Foundry toolkit available already. If the version supported is 6.11 or better, it is compatible with Bluemix and can be used. You can check what version is installed by running <a href="#checkCFversion">this test</a>.</p>
  <p>Alternatively, use the following steps to download and install the Cloud Foundry toolkit on your system: </p>
  <ol>
    <li>
      <p>A link to download the Cloud Foundry toolkit is available on the &#39;<code>Getting started</code>&#39; window of your application environment:<br>
        <img src="images/img0025.png" alt="A link to download the Cloud Foundry toolkit"></p>
    </li>
    <li>
      <p>Clicking the link takes you to a
        <a href="https://github.com/cloudfoundry/cli/releases" target="_blank">download page on GitHub <img src="../images/launch-glyph.svg" alt="External link icon" title="External link icon"></a>:<br>
        <img src="images/img0026.png" alt="The Cloud Foundry toolkit download page on GitHub"></p>
    </li>
    <li>
      <p>Download and run the most recent version of the installer for your system.</p>
    </li>
    <li>
      <p>
        <div id="checkCFversion"></div>To check that you have a working Cloud Foundry toolkit, run the following command at a prompt:</p>
      <pre class="pre"><code class="lang-sh hljs">cf --version
</code></pre>
      <p>Expect a result similar to the following output:</p>
      <pre class="codeblock"><code class="hljs">cf version 6.20.0+25b1961-2016-06-29
</code></pre>
      <blockquote>
        <p> <strong>Note</strong>: The Cloud Foundry toolkit version must be 6.11 or more recent for compatibility with Bluemix.</p>
      </blockquote>
    </li>
  </ol>
  <h3 id="installing-the-bluemix-toolkit">Installing the Bluemix toolkit</h3>
  <p>Use the following steps to download and install the Bluemix toolkit on your system.</p>
  <ol>
    <li>
      <p>A link to download the Bluemix toolkit is available on the &#39;<code>Getting started</code>&#39; window of your application:<br>
        <img src="images/img0027.png" alt="A link to download the Cloud Foundry toolkit"></p>
    </li>
    <li>
      <p>Clicking the link takes you to a
        <a href="http://clis.ng.bluemix.net/ui/home.html" target="_blank">download page <img src="../images/launch-glyph.svg" alt="External link icon" title="External link icon"></a>:<br>
        <img src="images/img0028.png" alt="The Bluemix toolkit download page"></p>
    </li>
    <li>
      <p>Download and run the appropriate installer for your system.</p>
      <p>The installer checks to ensure that you have a suitable version of the Cloud Foundry toolkit installed. If everything is correct, the Bluemix toolkit installs on your system.</p>
    </li>
    <li>
      <p>To check that you have a working Bluemix toolkit, run the following command at a prompt:</p>
      <pre class="pre"><code class="lang-sh hljs">bluemix --version
</code></pre>
      <p>Expect a result similar to the following output:</p>
      <pre class="codeblock"><code class="hljs">bluemix version 0.4.5+03c29de-2016-12-08T07:01:01+00:00
</code></pre>
    </li>
  </ol>
  <p>The tools to work with Bluemix applications are now available. The next step is to obtain the &#39;starter&#39; materials to help you create a Bluemix application.</p>
  <div id="starter"></div>
  <h2 id="the-starter-application">The &#39;starter&#39; application</h2>
  <p>This section of the tutorial describes a Bluemix starter application, and explains how you customize it to access a Cloudant NoSQL DB database instance.</p>
  <p>A Bluemix starter application is the minimum possible collection of source and configuration files necessary to create a working Bluemix application. In some regards, it is similar to a <a href="https://en.wikipedia.org/wiki/%22Hello,_World!%22_program"
      target="_blank">&#39;Hello World&#39; application <img src="../images/launch-glyph.svg" alt="External link icon" title="External link icon"></a>; sufficient only to show that the basic system and configuration is working correctly.</p>
  <p>A Bluemix starter application is an archive of example files that you must modify or extend as you develop your Bluemix application.</p>
  <p>Three files in particular are essential:</p>
  <ul>
    <li><a href="#procfile">&#39;<code>Procfile</code>&#39;</a></li>
    <li><a href="#manifest">&#39;<code>manifest.yml</code>&#39;</a></li>
    <li><a href="#requirements">&#39;<code>requirements.txt</code>&#39;</a></li>
  </ul>
  <div id="procfile"></div>
  <h3 id="the-procfile-file">The &#39;<code>Procfile</code>&#39; file</h3>
  <p>The &#39;<code>Procfile</code>&#39; contains the details that Bluemix needs to run your application.</p>
  <p>More specifically, a &#39;<code>Procfile</code>&#39; is a Cloud Foundry artifact that defines an application process type, and the command to run the application. More information about &#39;<code>Procfile</code>&#39; is available
    <a href="https://docs.cloudfoundry.org/buildpacks/prod-server.html#procfile" target="_blank">here <img src="../images/launch-glyph.svg" alt="External link icon" title="External link icon"></a>.</p>
  <p>The &#39;<code>Procfile</code>&#39; for a Bluemix Python starter application looks similar to the following example:</p>
  <pre class="codeblock"><code class="hljs">web: python server.py
</code></pre>
  <p>This example indicates that the application is a Python web application, and that it is started by running the command:</p>
  <pre class="codeblock"><code class="lang-sh hljs">python server.py
</code></pre>
  <p>A starter &#39;<code>server.py</code>&#39; Python source file is included in the starter application archive. The &#39;<code>server.py</code>&#39; file is modified for your application. Alternatively, create an entirely new Python source file. Then,
    update the &#39;<code>Procfile</code>&#39; so that the new file is used when your application starts.</p>
  <div id="manifest"></div>
  <h3 id="the-manifest-yml-file">The &#39;<code>manifest.yml</code>&#39; file</h3>
  <p>The &#39;<code>manifest.yml</code>&#39; file is a full description of the application, and of the environment it requires to run.</p>
  <p>The file for a Bluemix Python starter application looks similar to the following example:</p>
  <pre class="codeblock"><code class="hljs">applications:
- path: .
  memory: 128M
  instances: 1
  domain: mybluemix.net
  name: Cloudant Python
  host: Cloudant-Python
  disk_quota: 1024M
  services:
  - Cloudant Service 2017
</code></pre>
  <p>Three points are worth noting:</p>
  <ul>
    <li>The &#39;<code>domain</code>&#39;, &#39;
      <code>name</code>&#39;, and &#39;<code>host</code>&#39; values correspond to the values entered when your Bluemix application was <a href="#creating">created</a>.</li>
    <li>The &#39;<code>name</code>&#39; value is used by the Cloud Foundry toolkit to identify the application you are administering.</li>
    <li>The &#39;<code>services</code>&#39; value confirms that the &#39;<code>Cloudant Service 2017</code>&#39; Cloudant NoSQL DB database instance is connected to the application environment.</li>
  </ul>
  <p>You do not normally need to modify the &#39;<code>manifest.yml</code>&#39; file, however it is helpful to understand why it must be present for your application to work.</p>
  <div id="requirements"></div>
  <h3 id="the-requirements-txt-file">The &#39;<code>requirements.txt</code>&#39; file</h3>
  <p>The &#39;<code>requirements.txt</code>&#39; file specifies any additional components that are required for your application to work.</p>
  <p>In the starter application, the &#39;<code>requirements.txt</code>&#39; file is empty.</p>
  <p>However, in this tutorial the Python application accesses a Cloudant NoSQL DB database instance. Therefore, the application must be able to use the
    <a href="../libraries/supported.html#python">Cloudant NoSQL DB client library for Python applications</a>.</p>
  <p>To enable the Python client library, modify the &#39;<code>requirements.txt</code>&#39; file to read:</p>
  <pre class="codeblock"><code class="hljs">cloudant==2.3.1
</code></pre>
  <h2 id="the-next-step">The next step</h2>
  <p>The next step in the tutorial is to <a href="create_bmxapp_createapp.html">create the application</a>.</p>
  <footer>
    <div>
      <p>Copyright &copy; 2015, 2017. All Rights Reserved.</p>
    </div>
  </footer>
</body>
</html>